<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="title" content="ビルドインサーバについて.html"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="description" content="ディスクリプション"/>
  <meta name="keywords" content="キーワード"/>

  <!-- Common -->
  <link rel="stylesheet" type="text/css" href="https://masa1724.github.io/document/public_css/reset.css" media="all"/>
  <link rel="stylesheet" type="text/css" href="https://masa1724.github.io/document/public_css/common.css" media="all"/>
  <!--PC-->
  <link rel="stylesheet" type="text/css" href="https://masa1724.github.io/document/public_css/pc.css" media="screen and (min-device-width:481px)"/>
  <!--スマホ-->
  <link rel="stylesheet" type="text/css" href="https://masa1724.github.io/document/public_css/iphone.css" media="only screen and (max-device-width:480px)"/>

  <script type="text/javascript" src="https://masa1724.github.io/document/public_js/script.js"></script>
</head>
<body>
<pre style="background-color: #F4F4F4;padding 8px;">'
<!-- %{include_area}% -->
phpに組み込まれている簡易サーバーみたいなやつ。
.htaccessは使えない = ファイル拡張子をつけないとアクセスできない
なので、URL補正をするため、php側でルーティングを行う必要がある。


server_init.bat　サーバー起動
--------------------------------------------------------
@echo off

' WEBサイトのドキュメントルート
documentRoot="C:\\var\\www\\jsd"

' サーバーへのリクエスト時に介す処理を記述したphpファイル
router="C:\\var\\www\\router.php"

cd "%documentRoot%"
php -S localhost:8000 "%router%"

exit
--------------------------------------------------------


router.php ルーティング処理
--------------------------------------------------------
<?php
// ブラウザに入力されたドメイン以降のURL取得
// 例) localhost:8000/page_company
//     → /page_company
$path = $_SERVER["REQUEST_URI"];

// cssやjavascript等のリクエストもこの処理を介すので
// 関係ない拡張子の場合は無視する
if (preg_match('/\.(?:png|jpg|jpeg|gif|css|js|html)/', $path)) {
  return false;
}

// ルートへのアクセスの場合は、そのまま返す(デフォルトでindex.phpを返してくれる。)
if (preg_match('/\/$/', $path)) {
  return false;
}

// 拡張子「.php」がついていなければ付加する
if(!preg_match("/\.php$/", $path)){
  return require($path . ".php");
}

return false;
?>
--------------------------------------------------------

</pre>
</body>
</html>
